//
// This module implements a class responsible for displaying progress.
//
#include "stdafx.h"

// C/C++ standard headers
// Other external headers
// Windows headers
// Original headers
#include "Progress.h"


////////////////////////////////////////////////////////////////////////////////
//
// macro utilities
//


////////////////////////////////////////////////////////////////////////////////
//
// constants and macros
//


////////////////////////////////////////////////////////////////////////////////
//
// types
//

Progress::Progress(
    __in ExtExtension* Ext)
    : m_Ext(Ext)
    , m_Progress(0)
{
}


Progress::~Progress()
{
    m_Ext->Out("\n");
}


Progress& Progress::operator++()
{
    if (m_Progress == 70)
    {
        m_Progress = 0;
        m_Ext->Out("\n");
    }
    ++m_Progress;
    m_Ext->Out(".");
    return *this;
}


////////////////////////////////////////////////////////////////////////////////
//
// prototypes
//


////////////////////////////////////////////////////////////////////////////////
//
// variables
//


////////////////////////////////////////////////////////////////////////////////
//
// implementations
//

